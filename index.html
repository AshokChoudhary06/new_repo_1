<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Valentine's Day ‚ù§Ô∏è</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: #0a1628;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('/mnt/user-data/uploads/WhatsApp_Image_2026-02-14_at_10_05_49_PM.jpeg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            z-index: -3;
        }

        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            z-index: -2;
        }

        .stars {
            display: none;
        }

        .star {
            display: none;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        .couple-silhouette {
            display: none;
        }

        .hill {
            display: none;
        }

        .couple {
            display: none;
        }

        .person-left {
            display: none;
        }

        .person-left::before {
            display: none;
        }

        .person-right {
            display: none;
        }

        .person-right::before {
            display: none;
        }

        .person-right::after {
            display: none;
        }

        .shooting-star {
            position: fixed;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            z-index: -2;
            opacity: 0;
            animation: shoot 3s ease-out infinite;
        }

        @keyframes shoot {
            0% {
                opacity: 1;
                transform: translateX(0) translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateX(-300px) translateY(300px);
            }
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        .order-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            z-index: 2000;
            max-width: 90%;
            width: 500px;
            animation: modalAppear 0.4s ease-out;
            text-align: center;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1999;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes modalAppear {
            from {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .order-modal h3 {
            color: #d63447;
            font-size: 2em;
            margin-bottom: 20px;
        }

        .order-modal .delivery-icon {
            font-size: 4em;
            margin: 20px 0;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .order-details {
            background: linear-gradient(135deg, #fff5f7 0%, #ffe8ec 100%);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: left;
        }

        .order-details p {
            margin: 10px 0;
            font-size: 1.1em;
            color: #333;
        }

        .order-details strong {
            color: #d63447;
        }

        .contact-number {
            background: #d63447;
            color: white;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.3em;
            font-weight: bold;
            margin: 15px 0;
            letter-spacing: 1px;
        }

        .close-modal-btn {
            background: linear-gradient(135deg, #d63447 0%, #ff6b9d 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .close-modal-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(214, 52, 71, 0.4);
        }

        @media (max-width: 768px) {
            .order-modal {
                padding: 30px 20px;
                width: 90%;
            }

            .order-modal h3 {
                font-size: 1.5em;
            }

            .contact-number {
                font-size: 1.1em;
            }
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 40px 20px;
            animation: fadeIn 1s ease-in;
        }

        h1 {
            font-size: 3em;
            color: #ff6b9d;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3), 0 0 20px rgba(255, 107, 157, 0.5);
            margin-bottom: 10px;
        }

        .heart {
            display: inline-block;
            animation: heartbeat 1.5s infinite;
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.1); }
            50% { transform: scale(1); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section {
            background: rgba(255, 255, 255, 0.92);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
            animation: slideUp 0.8s ease-out;
            backdrop-filter: blur(10px);
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section h2 {
            color: #d63447;
            font-size: 2em;
            margin-bottom: 20px;
            border-bottom: 3px solid #ffc1cc;
            padding-bottom: 10px;
        }

        .about-content {
            line-height: 1.8;
            color: #333;
            font-size: 1.1em;
        }

        .food-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .food-item {
            background: linear-gradient(135deg, #fff5f7 0%, #ffe8ec 100%);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .food-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(214, 52, 71, 0.2);
        }

        .food-item.selected {
            border-color: #d63447;
            background: linear-gradient(135deg, #ffe8ec 0%, #ffc1cc 100%);
            transform: scale(1.05);
        }

        .food-item.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            position: relative;
            transition: all 0.3s ease;
        }

        .food-item.disabled:hover {
            transform: translateX(0) translateY(0);
            box-shadow: none;
        }

        .food-item.repel {
            animation: repelCursor 0.3s ease-out;
        }

        @keyframes repelCursor {
            0% { transform: translate(0, 0); }
            25% { transform: translate(var(--repel-x), var(--repel-y)); }
            50% { transform: translate(calc(var(--repel-x) * 0.5), calc(var(--repel-y) * 0.5)); }
            100% { transform: translate(0, 0); }
        }

        .food-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .food-name {
            font-size: 1.2em;
            color: #d63447;
            font-weight: bold;
        }

        .selections-display {
            background: linear-gradient(135deg, #fff9e6 0%, #ffe8cc 100%);
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
        }

        .selections-display h3 {
            color: #d63447;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .selected-items {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .selected-tag {
            background: white;
            padding: 10px 20px;
            border-radius: 25px;
            color: #d63447;
            font-weight: bold;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .empty-state {
            color: #999;
            font-style: italic;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2em;
            }

            .section {
                padding: 20px;
            }

            .section h2 {
                font-size: 1.5em;
            }

            .food-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }

        .mode-indicator {
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 20px;
            border-radius: 25px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
            color: #d63447;
        }
    </style>
</head>
<body>
    <!-- Animated Stars Background -->
    <div class="stars" id="starsContainer"></div>
    
    <!-- Shooting Stars -->
    <div class="shooting-star" style="top: 10%; right: 20%; animation-delay: 0s;"></div>
    <div class="shooting-star" style="top: 30%; right: 60%; animation-delay: 5s;"></div>
    <div class="shooting-star" style="top: 20%; right: 80%; animation-delay: 8s;"></div>
    
    <!-- Couple Silhouette on Hill -->
    <div class="couple-silhouette">
        <div class="hill"></div>
        <div class="couple">
            <div class="person-left"></div>
            <div class="person-right"></div>
        </div>
    </div>

    <div class="container">
        <header>
            <h1>Happy Valentine's Day <span class="heart">‚ù§Ô∏è</span></h1>
            <h2 style="color: #ffc1d9; font-size: 2.5em; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); margin: 15px 0; font-family: 'Brush Script MT', cursive;">Chetna</h2>
            <p style="color: #ffc1d9; font-size: 1.2em; text-shadow: 1px 1px 2px rgba(0,0,0,0.3);">A special day for a special person</p>
        </header>

        <div class="mode-indicator" id="modeIndicator">Loading...</div>

        <!-- About Her Section -->
        <div class="section">
            <h2>About Chetna üíï</h2>
            <div class="about-content">
                <p>Chetna is the one who brings light to every day, whose smile can brighten the darkest moments. 
                Her kindness knows no bounds, and her laughter is the sweetest melody. She's smart, beautiful, 
                and has a heart of gold. Every moment with her is a treasure, and every day is better because 
                she's in it.</p>
                <p style="margin-top: 15px;">She deserves all the love, happiness, and sweet treats in the world. 
                Today and every day, she's celebrated and cherished.</p>
            </div>
        </div>

        <!-- Food Preferences Section -->
        <div class="section">
            <h2>What Would You Like? üç∞</h2>
            <p style="color: #666; margin-bottom: 20px;">Only Ice Cream üç¶ and Chocolate üç´ are available today! üíï</p>
            
            <div class="food-grid">
                <div class="food-item" data-food="Ice Cream" onclick="toggleSelection('Ice Cream', 'üç¶')">
                    <div class="food-icon">üç¶</div>
                    <div class="food-name">Ice Cream</div>
                </div>
                
                <div class="food-item" data-food="Chocolate" onclick="toggleSelection('Chocolate', 'üç´')">
                    <div class="food-icon">üç´</div>
                    <div class="food-name">Chocolate</div>
                </div>
                
                <div class="food-item disabled" data-food="Cake" onclick="repelItem(this)">
                    <div class="food-icon">üéÇ</div>
                    <div class="food-name">Cake</div>
                </div>
                
                <div class="food-item disabled" data-food="Cookies" onclick="repelItem(this)">
                    <div class="food-icon">üç™</div>
                    <div class="food-name">Cookies</div>
                </div>
                
                <div class="food-item disabled" data-food="Candy" onclick="repelItem(this)">
                    <div class="food-icon">üç¨</div>
                    <div class="food-name">Candy</div>
                </div>
                
                <div class="food-item disabled" data-food="Cupcake" onclick="repelItem(this)">
                    <div class="food-icon">üßÅ</div>
                    <div class="food-name">Cupcake</div>
                </div>
            </div>
        </div>

        <!-- Selections Display Section -->
        <div class="section">
            <div class="selections-display">
                <h3>Selected Treats ‚ú®</h3>
                <div class="selected-items" id="selectedItems">
                    <div class="empty-state">No treats selected yet...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Generate random stars
        function createStars() {
            const starsContainer = document.getElementById('starsContainer');
            const numberOfStars = 100;
            
            for (let i = 0; i < numberOfStars; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                
                const size = Math.random() * 3 + 1;
                const left = Math.random() * 100;
                const top = Math.random() * 70;
                const delay = Math.random() * 3;
                
                star.style.width = size + 'px';
                star.style.height = size + 'px';
                star.style.left = left + '%';
                star.style.top = top + '%';
                star.style.animationDelay = delay + 's';
                
                starsContainer.appendChild(star);
            }
        }
        
        createStars();

        function repelItem(element) {
            // Only repel if not in viewer mode
            if (isViewer) {
                alert('You are in viewing mode. Share the main link with her to let her make selections!');
                return;
            }

            // Calculate random repel direction
            const angle = Math.random() * Math.PI * 2;
            const distance = 20 + Math.random() * 20;
            const repelX = Math.cos(angle) * distance;
            const repelY = Math.sin(angle) * distance;

            // Set CSS variables for repel animation
            element.style.setProperty('--repel-x', repelX + 'px');
            element.style.setProperty('--repel-y', repelY + 'px');

            // Add repel class
            element.classList.add('repel');

            // Show cute message
            const messages = [
                '‚ùå Sorry! Only Ice Cream and Chocolate are available today! üç¶üç´',
                'üíù Oops! Please choose Ice Cream or Chocolate only!',
                '‚ú® Nice try! But only Ice Cream and Chocolate are on the menu! üç¶üç´',
                'üíï That one is not available! Stick to Ice Cream and Chocolate!'
            ];
            
            const randomMessage = messages[Math.floor(Math.random() * messages.length)];
            
            // Create a temporary message element
            if (!document.querySelector('.restriction-message')) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'restriction-message';
                messageDiv.textContent = randomMessage;
                messageDiv.style.cssText = `
                    position: fixed;
                    top: 20px;
                    left: 50%;
                    transform: translateX(-50%);
                    background: rgba(255, 255, 255, 0.95);
                    color: #d63447;
                    padding: 15px 30px;
                    border-radius: 25px;
                    font-weight: bold;
                    box-shadow: 0 5px 20px rgba(0,0,0,0.3);
                    z-index: 1000;
                    animation: slideDown 0.3s ease-out;
                `;
                document.body.appendChild(messageDiv);

                setTimeout(() => {
                    messageDiv.style.animation = 'slideUp 0.3s ease-out';
                    setTimeout(() => messageDiv.remove(), 300);
                }, 2500);
            }

            // Remove repel class after animation
            setTimeout(() => {
                element.classList.remove('repel');
            }, 300);
        }

        let selections = [];
        const STORAGE_KEY = 'valentine-selections';

        // Determine if this is the selector or viewer based on URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const isViewer = urlParams.get('view') === 'true';

        // Update mode indicator
        document.getElementById('modeIndicator').textContent = isViewer ? 
            'üëÅÔ∏è Viewing Mode - You can see her selections in real-time!' : 
            'üíù Selection Mode - Choose your favorite treats!';

        async function loadSelections() {
            try {
                const result = await window.storage.get(STORAGE_KEY, true);
                if (result && result.value) {
                    selections = JSON.parse(result.value);
                    updateUI();
                }
            } catch (error) {
                console.log('No existing selections or error loading:', error);
                selections = [];
            }
        }

        async function saveSelections() {
            try {
                await window.storage.set(STORAGE_KEY, JSON.stringify(selections), true);
            } catch (error) {
                console.error('Error saving selections:', error);
            }
        }

        async function toggleSelection(foodName, icon) {
            // Only allow selection if not in viewer mode
            if (isViewer) {
                alert('You are in viewing mode. Share the main link with her to let her make selections!');
                return;
            }

            const index = selections.findIndex(item => item.name === foodName);
            
            if (index > -1) {
                // Remove selection
                selections.splice(index, 1);
            } else {
                // Add selection and show order confirmation
                selections.push({ name: foodName, icon: icon });
                showOrderConfirmation(foodName, icon);
            }
            
            await saveSelections();
            updateUI();
        }

        function showOrderConfirmation(foodName, icon) {
            // Create modal overlay
            const overlay = document.createElement('div');
            overlay.className = 'modal-overlay';
            
            // Create modal
            const modal = document.createElement('div');
            modal.className = 'order-modal';
            modal.innerHTML = `
                <h3>üéâ Order Confirmed! üéâ</h3>
                <div class="delivery-icon">üõµ</div>
                <div class="order-details">
                    <p><strong>Your Order:</strong> ${icon} ${foodName}</p>
                    <p><strong>Status:</strong> On the way! üöÄ</p>
                    <p><strong>Delivery Guy:</strong> Ashok üë®‚Äçü¶±</p>
                    <p style="font-size: 0.95em; color: #666; margin-top: 15px;">Need to contact your delivery guy?</p>
                </div>
                <div class="contact-number">üìû 8652281082</div>
                <p style="color: #999; font-size: 0.9em; margin-top: 10px;">Ashok will deliver your ${foodName} with love! üíù</p>
                <button class="close-modal-btn" onclick="playGameWhileWaiting()" style="background: linear-gradient(135deg, #ff6b9d 0%, #d63447 100%);">üéÆ Play Game While Waiting! üéÆ</button>
                <button class="close-modal-btn" onclick="closeOrderModal()" style="background: #999; margin-top: 10px;">Close</button>
            `;
            
            document.body.appendChild(overlay);
            document.body.appendChild(modal);
            
            // Close modal when clicking overlay
            overlay.onclick = closeOrderModal;
        }

        function playGameWhileWaiting() {
            window.location.href = 'valentine-game.html';
        }

        function closeOrderModal() {
            const overlay = document.querySelector('.modal-overlay');
            const modal = document.querySelector('.order-modal');
            
            if (overlay) overlay.remove();
            if (modal) modal.remove();
        }

        function updateUI() {
            // Update food items
            document.querySelectorAll('.food-item').forEach(item => {
                const foodName = item.dataset.food;
                const isSelected = selections.some(s => s.name === foodName);
                item.classList.toggle('selected', isSelected);
            });

            // Update selected items display
            const selectedItemsDiv = document.getElementById('selectedItems');
            
            if (selections.length === 0) {
                selectedItemsDiv.innerHTML = '<div class="empty-state">No treats selected yet...</div>';
            } else {
                selectedItemsDiv.innerHTML = selections.map(item => 
                    `<div class="selected-tag">${item.icon} ${item.name}</div>`
                ).join('');
            }
        }

        // Poll for changes every 2 seconds if in viewer mode
        if (isViewer) {
            setInterval(loadSelections, 2000);
        }

        // Initial load
        loadSelections();
    </script>
</body>
</html>
